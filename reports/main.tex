% -------------------------
%	Author: ToanHac
%	Created: 25.11.2025
%	Project: Data Warehouse & DSS for Bank Customer Churn
% -------------------------
\documentclass[a4paper]{article}
\usepackage{a4wide,amssymb,epsfig,latexsym,multicol,array,hhline,fancyhdr}
\usepackage{vntex}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{lastpage}
\usepackage{indentfirst}
\usepackage[lined,boxed,commentsnumbered]{algorithm2e}
\usepackage{enumerate}
\usepackage{color}
\usepackage{graphicx}							% Standard graphics package
\usepackage{array}
\usepackage{tabularx, caption}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{rotating}
\usepackage{graphics}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{epsfig}
\usepackage{tikz}
\usetikzlibrary{arrows,snakes,backgrounds}
\usepackage{hyperref}
\hypersetup{urlcolor=blue,linkcolor=black,citecolor=black,colorlinks=true} 
%\usepackage{pstcol} 								% PSTricks with the standard color package
\usepackage{subcaption}
\usepackage{pgfplots}
\pgfplotsset{compat=1.15}
\usepackage{mathrsfs}
\usetikzlibrary{arrows}
\pagestyle{empty}
\usepackage{longtable}

\usepackage{listings}
% Color definitions
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{bg}{HTML}{F6F8FA} % Background like GitHub
\definecolor{keyword}{HTML}{D73A49} % Red keywords
\definecolor{identifier}{HTML}{1F1F1F} % Blue variables
\definecolor{builtin}{HTML}{6F42C1} % Purple builtins
\definecolor{stringcolor}{HTML}{032F62} % Dark blue string
\definecolor{commentcolor}{HTML}{6A737D} % Soft gray comment
\definecolor{codeyellow}{HTML}{F57F17} % String color

% Python listing style
\lstdefinestyle{python}{
    language=Python,
    backgroundcolor=\color{bg},
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keyword}\bfseries,
    identifierstyle=\color{identifier},
    stringstyle=\color{codeyellow},
    commentstyle=\color{commentcolor}\itshape,
    numberstyle=\tiny\color{codegray},
    numbers=left,
    numbersep=5pt,
    tabsize=4,
    frame=single,
    breaklines=true,
    showstringspaces=false,
    showspaces=false,
    keepspaces=true,
    morekeywords={self, isnull}, % Python-specific
    rulecolor=\color{codegray},
    framexleftmargin=3.5mm,
    xleftmargin=12pt,
    aboveskip=12pt,
    belowskip=12pt,
    linewidth=\linewidth,
    inputencoding=utf8,
    extendedchars=true
}

% SQL listing style
\lstdefinestyle{sql}{
    language=SQL,
    backgroundcolor=\color{bg},
    basicstyle=\ttfamily\small,
    keywordstyle=\color{keyword}\bfseries,
    identifierstyle=\color{identifier},
    stringstyle=\color{codeyellow},
    commentstyle=\color{commentcolor}\itshape,
    numberstyle=\tiny\color{codegray},
    numbers=left,
    numbersep=5pt,
    tabsize=4,
    frame=single,
    breaklines=true,
    showstringspaces=false,
    morekeywords={SELECT, FROM, WHERE, JOIN, GROUP, BY, ORDER, HAVING, AS, ON, LEFT, RIGHT, INNER, OUTER},
    rulecolor=\color{codegray},
    framexleftmargin=3.5mm,
    xleftmargin=12pt,
    aboveskip=12pt,
    belowskip=12pt,
    linewidth=\linewidth
}

\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

\AtBeginDocument{\renewcommand*\contentsname{Mục lục}}
\AtBeginDocument{\renewcommand*\refname{Tài liệu tham khảo}}
%\usepackage{fancyhdr}
\setlength{\headheight}{40pt}
\pagestyle{fancy}
\fancyhead{} % clear all header fields
\fancyhead[L]{
 \begin{tabular}{rl}
    \begin{picture}(25,15)(0,0)
    \put(0,-8){\includegraphics[width=8mm, height=8mm]{Images/hcmut.png}}
    %\put(0,-8){\epsfig{width=10mm,figure=hcmut.eps}}
   \end{picture}&
	%\includegraphics[width=8mm, height=8mm]{hcmut.png} & %
	\begin{tabular}{l}
		\textbf{\bf \ttfamily Trường Đại học Bách khoa, Tp. Hồ Chí Minh}\\
		\textbf{\bf \ttfamily Khoa Khoa học và Kỹ thuật máy tính}
	\end{tabular} 	
 \end{tabular}
}
\fancyhead[R]{
	\begin{tabular}{l}
		\tiny \bf \\
		\tiny \bf 
	\end{tabular}  }
\fancyfoot{} % clear all footer fields
\fancyfoot[L]{\scriptsize \ttfamily Bài tập lớn Kho dữ liệu và Hệ hỗ trợ quyết định - Học kỳ 242}
\fancyfoot[R]{\scriptsize \ttfamily Trang {\thepage}/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0.3pt}


%%%
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{3}
\makeatletter
\newcounter {subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection .\@alph\c@subsubsubsection}
\newcommand\subsubsubsection{\@startsection{subsubsubsection}{4}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\normalfont\normalsize\bfseries}}
\newcommand*\l@subsubsubsection{\@dottedtocline{3}{10.0em}{4.1em}}
\newcommand*{\subsubsubsectionmark}[1]{}
\makeatother


\begin{document}

\begin{titlepage}
\begin{tikzpicture}[remember picture,overlay,inner sep=0,outer sep=0]
	\draw[blue!70!black,line width=4pt] ([xshift=-1.5cm,yshift=-2cm]current page.north east) coordinate (A)--([xshift=1.5cm,yshift=-2cm]current page.north west) coordinate(B)--([xshift=1.5cm,yshift=2cm]current page.south west) coordinate (C)--([xshift=-1.5cm,yshift=2cm]current page.south east) coordinate(D)--cycle;
\end{tikzpicture}
\begin{center}
\textbf{\large ĐẠI HỌC QUỐC GIA TP. HỒ CHÍ MINH} \\
\textbf{\large TRƯỜNG ĐẠI HỌC BÁCH KHOA} \\
\textbf{\large KHOA KHOA HỌC VÀ KỸ THUẬT MÁY TÍNH}
\end{center}


\vspace{1cm}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=3cm]{Images/hcmut.png}
\end{center}
\end{figure}

\vspace{1cm}

\begin{center}
\begin{tabular}{c}
\multicolumn{1}{l}{\textbf{{\Large Kho dữ liệu và Hệ hỗ trợ quyết định}}}\\
~~\\
\hline
\\
\textbf{{\Large Kho dữ liệu \& Hệ hỗ trợ quyết định}}\\
\\
\textbf{{\Large cho bài toán Bank Customer Churn}}\\
\\
\hline
\end{tabular}
\end{center}

\vspace{0.3cm}

	\begin{table}[h]
		\centering
		\begin{tabular}{rrlcl}
			\hspace{2.25 cm} & GVHD: & Bùi Tiến Đức & & \\
			& SV thực hiện: & Hoa Toàn Hạc & -- & 2201917 \\
			& & Mai Huy Hiệp & -- & 2211045
		\end{tabular}
	\end{table}

\vspace{4cm}

\begin{center}
{\footnotesize TP. HỒ CHÍ MINH, THÁNG 11, 2025}
\end{center}
\end{titlepage}


\newpage
\tableofcontents
\newpage

% === Lời mở đầu === %
\section*{Lời mở đầu}
Trong bối cảnh ngành ngân hàng ngày càng cạnh tranh, việc giữ chân khách hàng hiện tại trở nên quan trọng hơn bao giờ hết. Hiện tượng khách hàng rời bỏ dịch vụ (customer churn) không chỉ gây tổn thất về doanh thu mà còn ảnh hưởng đến uy tín và vị thế của ngân hàng trên thị trường. Để giải quyết vấn đề này, các ngân hàng cần có khả năng phân tích dữ liệu khách hàng một cách toàn diện, từ đó đưa ra các quyết định chiến lược kịp thời và hiệu quả.

Đề tài \textbf{"Kho dữ liệu \& Hệ hỗ trợ quyết định cho bài toán Bank Customer Churn"} được thực hiện nhằm xây dựng một hệ thống hoàn chỉnh giúp phân tích và dự đoán khả năng khách hàng rời bỏ ngân hàng. Hệ thống bao gồm ba thành phần chính:

\begin{itemize}
    \item \textbf{Kho dữ liệu (Data Warehouse)}: Thiết kế theo mô hình ngôi sao (star schema) với các bảng chiều (dimension) và bảng sự kiện (fact), tổ chức dữ liệu theo cách tối ưu cho phân tích OLAP.
    \item \textbf{Quy trình ETL}: Trích xuất dữ liệu từ nguồn gốc (Kaggle), làm sạch, biến đổi và nạp vào kho dữ liệu, bao gồm cả feature engineering để tạo ra các đặc trưng mới phục vụ phân tích.
    \item \textbf{Hệ hỗ trợ quyết định (DSS)}: Kết hợp phân tích OLAP, trực quan hóa dữ liệu bằng Python, và mô hình học máy để dự đoán churn, từ đó cung cấp thông tin hỗ trợ ra quyết định cho ban quản lý.
\end{itemize}

Dự án sử dụng bộ dữ liệu \textit{Bank Customer Churn Modeling} từ Kaggle, bao gồm thông tin về 10,000 khách hàng với các thuộc tính như điểm tín dụng, quốc gia, giới tính, độ tuổi, số dư tài khoản, và trạng thái churn. Qua quá trình phân tích và xây dựng mô hình, chúng tôi kỳ vọng không chỉ đạt được độ chính xác cao trong dự đoán mà còn rút ra được những insight quan trọng về các yếu tố ảnh hưởng đến quyết định rời bỏ của khách hàng.

Báo cáo này trình bày chi tiết về thiết kế kho dữ liệu, quy trình ETL, các phân tích OLAP, trực quan hóa, mô hình dự đoán, và cách thức hệ thống hỗ trợ ra quyết định trong thực tế. Đây là một bài tập lớn thuộc môn học \textit{Kho dữ liệu và Hệ hỗ trợ quyết định}, nhằm áp dụng các kiến thức lý thuyết vào giải quyết một bài toán thực tiễn trong lĩnh vực ngân hàng.

\newpage

% === Nội dung chính === %
\input{intro.tex}
\input{dwh_design.tex}
\input{etl.tex}
\input{analysis.tex}
\input{ml_model.tex}
\input{dss.tex}
\input{conclusion.tex}

% === Tài liệu tham khảo === %
\newpage
\begin{thebibliography}{9}

\bibitem{kimball2013}
Kimball, R., \& Ross, M. (2013). \textit{The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling} (3rd ed.). Wiley.

\bibitem{inmon2005}
Inmon, W. H. (2005). \textit{Building the Data Warehouse} (4th ed.). Wiley.

\bibitem{scikit-learn}
Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., ... \& Duchesnay, É. (2011). \textit{Scikit-learn: Machine learning in Python}. Journal of Machine Learning Research, 12, 2825–2830.

\bibitem{kaggle-churn}
Kaggle. \textit{Bank Customer Churn Modeling}. \url{https://www.kaggle.com/datasets/shrutimechlearn/churn-modelling}

\bibitem{matplotlib}
Hunter, J. D. (2007). \textit{Matplotlib: A 2D graphics environment}. Computing in Science \& Engineering, 9(3), 90–95.

\bibitem{pandas}
McKinney, W. (2010). \textit{Data structures for statistical computing in Python}. In Proceedings of the 9th Python in Science Conference (Vol. 445, pp. 51–56).

\end{thebibliography}

\end{document}
